{"ast":null,"code":"import { axiosApi } from \"./Axios\";\n\nconst axiosInterceptor = (loginState, loginDispatch, setRedirectToLogin, setLoading) => {\n  let axiosInterceptorRequest = axiosApi.interceptors.request.use(async config => {\n    var _loginState$user;\n\n    // console.log(\"interceptor=====>\", loginState);\n    setLoading(true); // console.log(\"loginapi=====> \", loginState);\n\n    let tokens = await (loginState === null || loginState === void 0 ? void 0 : (_loginState$user = loginState.user) === null || _loginState$user === void 0 ? void 0 : _loginState$user.accessToken);\n    if (tokens) // config.headers[\"auth_token\"] = await tokens;\n      config.headers[\"Authorization\"] = await tokens;\n    return config;\n  }, error => {\n    setLoading(false);\n    return Promise.reject(error);\n  });\n  let axiosInterceptorResponse = axiosApi.interceptors.response.use(response => {\n    setLoading(false);\n    return response;\n  }, async error => {\n    if (error.response.status === 403 || error.response.status === 401) {\n      if (setRedirectToLogin) {\n        setRedirectToLogin(true);\n      }\n\n      axiosApi.interceptors.response.eject(axiosInterceptorResponse);\n      axiosApi.interceptors.request.eject(axiosInterceptorRequest);\n      await loginDispatch({\n        type: \"userInfo\",\n        payload: {}\n      });\n    }\n\n    setLoading(false);\n    return Promise.reject(error);\n  });\n};\n\nexport default {\n  axiosInterceptor\n};","map":{"version":3,"names":["axiosApi","axiosInterceptor","loginState","loginDispatch","setRedirectToLogin","setLoading","axiosInterceptorRequest","interceptors","request","use","config","tokens","user","accessToken","headers","error","Promise","reject","axiosInterceptorResponse","response","status","eject","type","payload"],"sources":["/home/eagle/Projects/bouldl/src/Axios/Interceptors.js"],"sourcesContent":["import { axiosApi } from \"./Axios\";\r\n\r\nconst axiosInterceptor = (\r\n  loginState,\r\n  loginDispatch,\r\n  setRedirectToLogin,\r\n  setLoading\r\n) => {\r\n  let axiosInterceptorRequest = axiosApi.interceptors.request.use(\r\n    async (config) => {\r\n      // console.log(\"interceptor=====>\", loginState);\r\n      setLoading(true);\r\n      // console.log(\"loginapi=====> \", loginState);\r\n      let tokens = await loginState?.user?.accessToken;\r\n      if (tokens)\r\n        // config.headers[\"auth_token\"] = await tokens;\r\n        config.headers[\"Authorization\"] = await tokens;\r\n      return config;\r\n    },\r\n    (error) => {\r\n      setLoading(false);\r\n      return Promise.reject(error);\r\n    }\r\n  );\r\n\r\n  let axiosInterceptorResponse = axiosApi.interceptors.response.use(\r\n    (response) => {\r\n      setLoading(false);\r\n      return response;\r\n    },\r\n    async (error) => {\r\n      if (error.response.status === 403 || error.response.status === 401) {\r\n        if (setRedirectToLogin) {\r\n          setRedirectToLogin(true);\r\n        }\r\n        axiosApi.interceptors.response.eject(axiosInterceptorResponse);\r\n        axiosApi.interceptors.request.eject(axiosInterceptorRequest);\r\n        await loginDispatch({\r\n          type: \"userInfo\",\r\n          payload: {},\r\n        });\r\n      }\r\n      setLoading(false);\r\n      return Promise.reject(error);\r\n    }\r\n  );\r\n};\r\n\r\nexport default { axiosInterceptor };\r\n"],"mappings":"AAAA,SAASA,QAAT,QAAyB,SAAzB;;AAEA,MAAMC,gBAAgB,GAAG,CACvBC,UADuB,EAEvBC,aAFuB,EAGvBC,kBAHuB,EAIvBC,UAJuB,KAKpB;EACH,IAAIC,uBAAuB,GAAGN,QAAQ,CAACO,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CAC5B,MAAOC,MAAP,IAAkB;IAAA;;IAChB;IACAL,UAAU,CAAC,IAAD,CAAV,CAFgB,CAGhB;;IACA,IAAIM,MAAM,GAAG,OAAMT,UAAN,aAAMA,UAAN,2CAAMA,UAAU,CAAEU,IAAlB,qDAAM,iBAAkBC,WAAxB,CAAb;IACA,IAAIF,MAAJ,EACE;MACAD,MAAM,CAACI,OAAP,CAAe,eAAf,IAAkC,MAAMH,MAAxC;IACF,OAAOD,MAAP;EACD,CAV2B,EAW3BK,KAAD,IAAW;IACTV,UAAU,CAAC,KAAD,CAAV;IACA,OAAOW,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;EACD,CAd2B,CAA9B;EAiBA,IAAIG,wBAAwB,GAAGlB,QAAQ,CAACO,YAAT,CAAsBY,QAAtB,CAA+BV,GAA/B,CAC5BU,QAAD,IAAc;IACZd,UAAU,CAAC,KAAD,CAAV;IACA,OAAOc,QAAP;EACD,CAJ4B,EAK7B,MAAOJ,KAAP,IAAiB;IACf,IAAIA,KAAK,CAACI,QAAN,CAAeC,MAAf,KAA0B,GAA1B,IAAiCL,KAAK,CAACI,QAAN,CAAeC,MAAf,KAA0B,GAA/D,EAAoE;MAClE,IAAIhB,kBAAJ,EAAwB;QACtBA,kBAAkB,CAAC,IAAD,CAAlB;MACD;;MACDJ,QAAQ,CAACO,YAAT,CAAsBY,QAAtB,CAA+BE,KAA/B,CAAqCH,wBAArC;MACAlB,QAAQ,CAACO,YAAT,CAAsBC,OAAtB,CAA8Ba,KAA9B,CAAoCf,uBAApC;MACA,MAAMH,aAAa,CAAC;QAClBmB,IAAI,EAAE,UADY;QAElBC,OAAO,EAAE;MAFS,CAAD,CAAnB;IAID;;IACDlB,UAAU,CAAC,KAAD,CAAV;IACA,OAAOW,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;EACD,CAnB4B,CAA/B;AAqBD,CA5CD;;AA8CA,eAAe;EAAEd;AAAF,CAAf"},"metadata":{},"sourceType":"module"}